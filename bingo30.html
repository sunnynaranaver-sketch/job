<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>환경 진로 빙고 게임 (4x4)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; }
        .bingo-cell {
            width: calc(25% - 8px); /* 4x4 그리드에 맞게 너비 조정 */
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: transform 0.2s, background-color 0.2s;
            text-align: center;
            padding: 4px;
            word-break: keep-all;
        }
        .bingo-cell.marked {
            background-color: #fca5a5; /* Tailwind red-300 */
            color: white;
            text-decoration: line-through;
            transform: scale(0.95);
        }
        @media (max-width: 640px) {
            .bingo-cell {
                height: 60px;
                font-size: 0.7rem;
            }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 p-8 min-h-screen flex flex-col items-center justify-center">

    <div class="bg-white rounded-3xl shadow-xl p-8 md:p-12 max-w-4xl w-full text-center">
        <h1 class="text-3xl font-extrabold text-purple-600 mb-4">환경 진로 빙고 게임 (4x4)</h1>
        <p class="text-lg text-gray-600 mb-6">
            아래 직업 30개 중 16개를 선택하여 나만의 빙고판을 만들어보세요.
            <br>선택이 완료되면 '빙고판 만들기' 버튼이 활성화됩니다.
        </p>

        <!-- 직업 선택 섹션 -->
        <div id="job-selection" class="flex flex-wrap justify-center gap-2 mb-6">
            <!-- 직업 버튼들이 여기에 동적으로 생성됩니다 -->
        </div>

        <!-- 빙고판 만들기 버튼 -->
        <button id="create-bingo-btn" onclick="createBingoBoard()" disabled
            class="bg-gray-400 text-white font-bold py-3 px-6 rounded-lg shadow-md transition-colors duration-200">
            빙고판 만들기
        </button>

        <!-- 빙고 게임 섹션 (숨겨져 있음) -->
        <div id="bingo-game-section" class="hidden mt-8">
            <p class="text-lg font-bold text-gray-700 mb-4">선생님이 부르는 직업을 찾아 클릭하세요!</p>
            <div id="bingo-board" class="flex flex-wrap justify-center gap-2 p-4 bg-purple-100 rounded-xl shadow-inner">
                <!-- 빙고판 셀들이 여기에 동적으로 생성됩니다 -->
            </div>
            <div id="game-status" class="mt-4 text-xl font-bold text-green-600"></div>
        </div>
    </div>

    <script>
        // 환경 관련 30개 직업 목록
        const allJobs = [
            '기후적응 컨설턴트', '해양 산성화 모니터링 전문가', '수직농장 관리자', '스마트시티 기후 관리자', 
            '수소 연료 전지 기술자', '탄소 포집 기술자', '환경 AI 개발자', '바이오플라스틱 개발자',
            '순환 경제 디자이너', '기후 교육 게임 개발자', '기후 복원 분석가', '담수화 시스템 엔지니어',
            '곤충양식 기술자', '도시 열섬 완화 전문가', '에너지 저장 시스템 전문가', '탄소 발자국 추적 전문가',
            '환경 규제 법률 전문가', '친환경 제품 인증 평가사', '지속가능한 건축 설계사', '재생에너지 시스템 설치 및 유지보수 개발자',
            '환경 영향 평가 전문가', '생태관광 기획자', '기후금융 전문가', '녹색 기술 연구원',
            '폐기물 에너지화 연구원', '스마트 그리드 엔지니어', '환경 법률 전문가', '환경 다큐멘터리 제작자',
            '업사이클링 아티스트', '친환경 제품 마케터'
        ];

        let selectedJobs = new Set();
        let bingoBoard = [];
        const boardSize = 4; // 4x4 보드 크기

        /**
         * 직업 선택 버튼을 초기화하는 함수
         */
        function initJobSelection() {
            const selectionContainer = document.getElementById('job-selection');
            selectionContainer.innerHTML = '';
            
            allJobs.forEach(job => {
                const button = document.createElement('button');
                button.textContent = job;
                button.className = "bg-gray-200 text-gray-800 py-2 px-4 rounded-full hover:bg-purple-300 transition-colors duration-200";
                button.onclick = () => toggleJobSelection(job, button);
                selectionContainer.appendChild(button);
            });
        }

        /**
         * 직업 선택/선택 해제를 처리하는 함수
         * @param {string} job - 선택된 직업명
         * @param {HTMLElement} button - 클릭된 버튼 요소
         */
        function toggleJobSelection(job, button) {
            const createBtn = document.getElementById('create-bingo-btn');

            if (selectedJobs.has(job)) {
                selectedJobs.delete(job);
                button.classList.remove('bg-purple-500', 'text-white');
                button.classList.add('bg-gray-200', 'text-gray-800');
            } else {
                if (selectedJobs.size < boardSize * boardSize) {
                    selectedJobs.add(job);
                    button.classList.remove('bg-gray-200', 'text-gray-800');
                    button.classList.add('bg-purple-500', 'text-white');
                } else {
                    // 알림 대신 메시지 표시
                    alert(`${boardSize * boardSize}개의 직업을 모두 선택했습니다. 빙고판 만들기를 눌러주세요.`);
                }
            }
            
            // 16개 선택 시 빙고판 만들기 버튼 활성화
            if (selectedJobs.size === boardSize * boardSize) {
                createBtn.disabled = false;
                createBtn.classList.remove('bg-gray-400');
                createBtn.classList.add('bg-blue-600', 'hover:bg-blue-700');
            } else {
                createBtn.disabled = true;
                createBtn.classList.add('bg-gray-400');
                createBtn.classList.remove('bg-blue-600', 'hover:bg-blue-700');
            }
        }
        
        /**
         * 빙고판을 생성하고 화면에 표시하는 함수
         */
        function createBingoBoard() {
            if (selectedJobs.size !== boardSize * boardSize) {
                // 알림 대신 메시지 표시
                alert(`${boardSize * boardSize}개의 직업을 선택해야 빙고판을 만들 수 있습니다.`);
                return;
            }
            
            // Set을 배열로 변환하고 무작위로 섞기
            bingoBoard = Array.from(selectedJobs);
            for (let i = bingoBoard.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [bingoBoard[i], bingoBoard[j]] = [bingoBoard[j], bingoBoard[i]];
            }
            
            const boardContainer = document.getElementById('bingo-board');
            boardContainer.innerHTML = '';
            
            bingoBoard.forEach(job => {
                const cell = document.createElement('div');
                cell.textContent = job;
                cell.className = "bingo-cell bg-white text-gray-700 shadow-sm border border-purple-200 flex-grow-0";
                cell.onclick = () => markBingoCell(cell);
                boardContainer.appendChild(cell);
            });

            // 빙고 게임 섹션 보이기
            document.getElementById('job-selection').classList.add('hidden');
            document.getElementById('create-bingo-btn').classList.add('hidden');
            document.getElementById('bingo-game-section').classList.remove('hidden');
        }

        /**
         * 빙고 셀을 클릭하여 표시하는 함수
         * @param {HTMLElement} cell - 클릭된 빙고 셀 요소
         */
        function markBingoCell(cell) {
            cell.classList.toggle('marked');
            checkBingo();
        }

        /**
         * 빙고 완성 여부를 확인하는 함수
         */
        function checkBingo() {
            const boardCells = document.getElementById('bingo-board').children;
            let bingoCount = 0;

            // 행(Row) 체크
            for (let i = 0; i < boardSize; i++) {
                if (Array.from({length: boardSize}, (_, j) => boardCells[i * boardSize + j].classList.contains('marked')).every(Boolean)) {
                    bingoCount++;
                }
            }

            // 열(Column) 체크
            for (let j = 0; j < boardSize; j++) {
                if (Array.from({length: boardSize}, (_, i) => boardCells[i * boardSize + j].classList.contains('marked')).every(Boolean)) {
                    bingoCount++;
                }
            }

            // 대각선 체크 (좌상단 -> 우하단)
            if (Array.from({length: boardSize}, (_, i) => boardCells[i * boardSize + i].classList.contains('marked')).every(Boolean)) {
                bingoCount++;
            }

            // 대각선 체크 (우상단 -> 좌하단)
            if (Array.from({length: boardSize}, (_, i) => boardCells[i * boardSize + (boardSize - 1 - i)].classList.contains('marked')).every(Boolean)) {
                bingoCount++;
            }

            const gameStatus = document.getElementById('game-status');
            if (bingoCount > 0) {
                gameStatus.textContent = `${bingoCount} 빙고 완성! 🎉`;
            } else {
                gameStatus.textContent = '';
            }
        }
        
        // 페이지 로드 시 직업 선택 초기화
        document.addEventListener('DOMContentLoaded', initJobSelection);
    </script>
</body>
</html>
